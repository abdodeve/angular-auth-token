!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs/operators"),require("@angular/common/http")):"function"==typeof define&&define.amd?define("auth-token",["exports","@angular/core","rxjs/operators","@angular/common/http"],t):t(e["auth-token"]={},e.ng.core,e.rxjs.operators,e.ng.common.http)}(this,function(e,t,n,s){"use strict";var r=(o.prototype.intercept=function(t,r){var o=this;return r.handle(t).pipe(n.catchError(function(e){if(e instanceof s.HttpErrorResponse&&401===e.status)return o.token?(t=t.clone({headers:t.headers.set("Authorization","Bearer "+o.token)}),o.refreshTokenAndRetry(t,r)):(console.warn("Token doesn't exist !","Bearer "+o.token),r.handle(t))}))},o.prototype.refreshTokenAndRetry=function(t,r){return this.http.post(this.refreshEndpoint,{}).pipe(n.switchMap(function(e){return console.log("response",e),localStorage.setItem("access-token",e["access-token"]),localStorage.setItem("refresh-token",e["refresh-token"]),t=t.clone({headers:t.headers.set("Authorization","Bearer "+e["refresh-token"])}),r.handle(t)}))},o.decorators=[{type:t.Injectable}],o.ctorParameters=function(){return[{type:s.HttpClient},{type:undefined,decorators:[{type:t.Inject,args:["environment"]}]}]},o);function o(e,t){this.http=e,this.environment=t,this.refreshEndpoint=this.environment["refreshtoken-endpoint"],this.token=localStorage.getItem("access-token"),this.refreshToken=localStorage.getItem("refresh-token")}var a=(i.decorators=[{type:t.NgModule,args:[{declarations:[],imports:[],exports:[],providers:[{provide:s.HTTP_INTERCEPTORS,useClass:r,multi:!0}]}]}],i);function i(){}e.AuthTokenModule=a,e.Éµa=r,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=auth-token.umd.min.js.map